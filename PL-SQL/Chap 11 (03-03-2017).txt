SQL> set lines 300
SQL> set pages 25
SQL> CREATE OR REPLACE FUNCTION get_sal
  2   (p_id  employees.employee_id%TYPE) RETURN NUMBER IS
  3  
  4  v_sal employees.salary%TYPE := 0;
  5  
  6  BEGIN
  7    SELECT salary
  8    INTO   v_sal
  9    FROM   employees
 10    WHERE  employee_id = p_id;
 11    RETURN v_sal;
 12  END get_sal;
 13  /

Function created.

SQL> 
SQL> SET SERVEROUTPUT ON
SQL> 
SQL> EXECUTE DBMS_OUTPUT.PUT_LINE(get_sal(100))
5942.02                                                                                                                                                                                                                                                                                                     

PL/SQL procedure successfully completed.

SQL> EXECUTE DBMS_OUTPUT.PUT_LINE('The salary of employee_id 100 is '||get_sal(100))
The salary of employee_id 100 is 5942.02                                                                                                                                                                                                                                                                    

PL/SQL procedure successfully completed.

SQL> VARIABLE b_salary NUMBER
SQL> EXECUTE :b_salary := get_sal(100)

PL/SQL procedure successfully completed.

SQL> PRINT b_salary

  B_SALARY                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
   5942.02                                                                                                                                                                                                                                                                                                  

SQL> EXECUTE DBMS_OUTPUT.PUT_LINE('The salary of employee_id 100 is '||get_sal(1000))
The salary of employee_id 100 is 4658.5                                                                                                                                                                                                                                                                     

PL/SQL procedure successfully completed.

SQL> EXECUTE DBMS_OUTPUT.PUT_LINE('The salary of employee_id 100 is '||get_sal(10000))
BEGIN DBMS_OUTPUT.PUT_LINE('The salary of employee_id 100 is '||get_sal(10000)); END;

*
ERROR at line 1:
ORA-01403: no data found 
ORA-06512: at "HR.GET_SAL", line 7 
ORA-06512: at line 1 


SQL> CREATE OR REPLACE FUNCTION get_salCREATE OR REPLACE FUNCTION get_sal
  2   (p_id  employees.employee_id%TYPE) RETURN NUMBER IS
  3  
  4  v_sal employees.salary%TYPE := 0;
  5  
  6  BEGIN
  7    SELECT salary
  8    INTO   v_sal
  9    FROM   employees
 10    WHERE  employee_id = p_id;
 11    RETURN v_sal;
 12  END get_sal;
 13  /

Warning: Function created with compilation errors.

SQL> show errors
Errors for FUNCTION GET_SALCREATE:

LINE/COL ERROR                                                                                                                                                                                                                                                                                              
-------- -----------------------------------------------------------------                                                                                                                                                                                                                                  
1/24     PLS-00103: Encountered the symbol "OR" when expecting one of the                                                                                                                                                                                                                                   
         following:                                                                                                                                                                                                                                                                                         
         ( return compress compiled wrapped                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                            
SQL> ed
Wrote file afiedt.buf

  1  CREATE OR REPLACE FUNCTION get_sal
  2   (p_id  employees.employee_id%TYPE) RETURN NUMBER IS
  3  v_sal employees.salary%TYPE := 0;
  4  BEGIN
  5    SELECT salary
  6    INTO   v_sal
  7    FROM   employees
  8    WHERE  employee_id = p_id;
  9    RETURN v_sal;
 10  exception
 11  when others then
 12  return 0;
 13* END get_sal;
 14  /

Function created.

SQL> EXECUTE DBMS_OUTPUT.PUT_LINE('The salary of employee_id 100 is '||get_sal(10000))
The salary of employee_id 100 is 0                                                                                                                                                                                                                                                                          

PL/SQL procedure successfully completed.

SQL> select job_id,get_sal(employee_id) from employees;

JOB_ID     GET_SAL(EMPLOYEE_ID)                                                                                                                                                                                                                                                                             
---------- --------------------                                                                                                                                                                                                                                                                             
AC_ACCOUNT             12152.03                                                                                                                                                                                                                                                                             
AC_MGR                 17580.92                                                                                                                                                                                                                                                                             
AD_ASST                 6764.14                                                                                                                                                                                                                                                                             
AD_PRES                   14520                                                                                                                                                                                                                                                                             
AD_PRES                 5942.02                                                                                                                                                                                                                                                                             
AD_VP                   1452.68                                                                                                                                                                                                                                                                             
AD_VP                   3162.24                                                                                                                                                                                                                                                                             
FI_ACCOUNT              13176.9                                                                                                                                                                                                                                                                             
FI_ACCOUNT             15253.14                                                                                                                                                                                                                                                                             
FI_ACCOUNT             11273.57                                                                                                                                                                                                                                                                             
FI_ACCOUNT             11419.98                                                                                                                                                                                                                                                                             
FI_ACCOUNT             10102.29                                                                                                                                                                                                                                                                             
FI_MGR                 19339.01                                                                                                                                                                                                                                                                             
HR_REP                  9516.65                                                                                                                                                                                                                                                                             
IT_PROG                  5989.5                                                                                                                                                                                                                                                                             
IT_PROG                    5445                                                                                                                                                                                                                                                                             
IT_PROG                 13176.9                                                                                                                                                                                                                                                                             
IT_PROG                 1370.18                                                                                                                                                                                                                                                                             
IT_PROG                 7027.68                                                                                                                                                                                                                                                                             
IT_PROG                 7027.68                                                                                                                                                                                                                                                                             
IT_PROG                   10890                                                                                                                                                                                                                                                                             
MK_MAN                     6050                                                                                                                                                                                                                                                                             

JOB_ID     GET_SAL(EMPLOYEE_ID)                                                                                                                                                                                                                                                                             
---------- --------------------                                                                                                                                                                                                                                                                             
MK_REP                   8784.6                                                                                                                                                                                                                                                                             
PR_REP                    14641                                                                                                                                                                                                                                                                             
PU_CLERK                4538.71                                                                                                                                                                                                                                                                             
PU_CLERK                4245.89                                                                                                                                                                                                                                                                             
PU_CLERK                4099.48                                                                                                                                                                                                                                                                             
PU_CLERK                3806.66                                                                                                                                                                                                                                                                             
PU_CLERK                3660.25                                                                                                                                                                                                                                                                             
PU_MAN                  16105.1                                                                                                                                                                                                                                                                             
SA_MAN                  20497.4                                                                                                                                                                                                                                                                             
SA_MAN                 19765.35                                                                                                                                                                                                                                                                             
SA_MAN                  17569.2                                                                                                                                                                                                                                                                             
SA_MAN                  16105.1                                                                                                                                                                                                                                                                             
SA_MAN                 15373.05                                                                                                                                                                                                                                                                             
SA_REP                     7986                                                                                                                                                                                                                                                                             
SA_REP                     8470                                                                                                                                                                                                                                                                             
SA_REP                    14641                                                                                                                                                                                                                                                                             
SA_REP                 13908.95                                                                                                                                                                                                                                                                             
SA_REP                  13176.9                                                                                                                                                                                                                                                                             
SA_REP                  11712.8                                                                                                                                                                                                                                                                             
SA_REP                 10980.75                                                                                                                                                                                                                                                                             
SA_REP                  10248.7                                                                                                                                                                                                                                                                             
SA_REP                    14641                                                                                                                                                                                                                                                                             

JOB_ID     GET_SAL(EMPLOYEE_ID)                                                                                                                                                                                                                                                                             
---------- --------------------                                                                                                                                                                                                                                                                             
SA_REP                 13908.95                                                                                                                                                                                                                                                                             
SA_REP                  13176.9                                                                                                                                                                                                                                                                             
SA_REP                  11712.8                                                                                                                                                                                                                                                                             
SA_REP                 10980.75                                                                                                                                                                                                                                                                             
SA_REP                  10248.7                                                                                                                                                                                                                                                                             
SA_REP                 15373.05                                                                                                                                                                                                                                                                             
SA_REP                 13908.95                                                                                                                                                                                                                                                                             
SA_REP                 10541.52                                                                                                                                                                                                                                                                             
SA_REP                  9955.88                                                                                                                                                                                                                                                                             
SA_REP                  9370.24                                                                                                                                                                                                                                                                             
SA_REP                  9077.42                                                                                                                                                                                                                                                                             
SA_REP                 16837.15                                                                                                                                                                                                                                                                             
SA_REP                    14641                                                                                                                                                                                                                                                                             
SA_REP                  8931.01                                                                                                                                                                                                                                                                             
SA_REP                  16105.1                                                                                                                                                                                                                                                                             
SA_REP                 12884.08                                                                                                                                                                                                                                                                             
SA_REP                 15235.43                                                                                                                                                                                                                                                                             
SA_REP                 12298.44                                                                                                                                                                                                                                                                             
SA_REP                  10248.7                                                                                                                                                                                                                                                                             
SA_REP                  9077.42                                                                                                                                                                                                                                                                             
SH_CLERK                3806.66                                                                                                                                                                                                                                                                             
SH_CLERK                3806.66                                                                                                                                                                                                                                                                             

JOB_ID     GET_SAL(EMPLOYEE_ID)                                                                                                                                                                                                                                                                             
---------- --------------------                                                                                                                                                                                                                                                                             
SH_CLERK                4685.12                                                                                                                                                                                                                                                                             
SH_CLERK                4538.71                                                                                                                                                                                                                                                                             
SH_CLERK                3660.25                                                                                                                                                                                                                                                                             
SH_CLERK                4099.48                                                                                                                                                                                                                                                                             
SH_CLERK                6149.22                                                                                                                                                                                                                                                                             
SH_CLERK                6002.81                                                                                                                                                                                                                                                                             
SH_CLERK                4977.94                                                                                                                                                                                                                                                                             
SH_CLERK                 4392.3                                                                                                                                                                                                                                                                             
SH_CLERK                5563.58                                                                                                                                                                                                                                                                             
SH_CLERK                5270.76                                                                                                                                                                                                                                                                             
SH_CLERK                4245.89                                                                                                                                                                                                                                                                             
SH_CLERK                3660.25                                                                                                                                                                                                                                                                             
SH_CLERK                 5856.4                                                                                                                                                                                                                                                                             
SH_CLERK                5709.99                                                                                                                                                                                                                                                                             
SH_CLERK                4685.12                                                                                                                                                                                                                                                                             
SH_CLERK                4099.48                                                                                                                                                                                                                                                                             
SH_CLERK                4538.71                                                                                                                                                                                                                                                                             
SH_CLERK                 4392.3                                                                                                                                                                                                                                                                             
ST_CLERK                 4658.5                                                                                                                                                                                                                                                                             
ST_CLERK                4685.12                                                                                                                                                                                                                                                                             
ST_CLERK                3953.07                                                                                                                                                                                                                                                                             
ST_CLERK                3513.84                                                                                                                                                                                                                                                                             

JOB_ID     GET_SAL(EMPLOYEE_ID)                                                                                                                                                                                                                                                                             
---------- --------------------                                                                                                                                                                                                                                                                             
ST_CLERK                3221.02                                                                                                                                                                                                                                                                             
ST_CLERK                4831.53                                                                                                                                                                                                                                                                             
ST_CLERK                4099.48                                                                                                                                                                                                                                                                             
ST_CLERK                3660.25                                                                                                                                                                                                                                                                             
ST_CLERK                3074.61                                                                                                                                                                                                                                                                             
ST_CLERK                4831.53                                                                                                                                                                                                                                                                             
ST_CLERK                4245.89                                                                                                                                                                                                                                                                             
ST_CLERK                3513.84                                                                                                                                                                                                                                                                             
ST_CLERK                3221.02                                                                                                                                                                                                                                                                             
ST_CLERK                5270.76                                                                                                                                                                                                                                                                             
ST_CLERK                   4114                                                                                                                                                                                                                                                                             
ST_CLERK                3953.07                                                                                                                                                                                                                                                                             
ST_CLERK                3660.25                                                                                                                                                                                                                                                                             
ST_CLERK                5124.35                                                                                                                                                                                                                                                                             
ST_CLERK                4538.71                                                                                                                                                                                                                                                                             
ST_CLERK                3806.66                                                                                                                                                                                                                                                                             
ST_CLERK                3660.25                                                                                                                                                                                                                                                                             
ST_MAN                  11712.8                                                                                                                                                                                                                                                                             
ST_MAN                 12005.62                                                                                                                                                                                                                                                                             
ST_MAN                 11566.39                                                                                                                                                                                                                                                                             
ST_MAN                  9516.65                                                                                                                                                                                                                                                                             
ST_MAN                  8491.78                                                                                                                                                                                                                                                                             

110 rows selected.

SQL> select get_sal(100) from dual;

GET_SAL(100)                                                                                                                                                                                                                                                                                                
------------                                                                                                                                                                                                                                                                                                
     5942.02                                                                                                                                                                                                                                                                                                

SQL> select get_sal(10000) from dual;

GET_SAL(10000)                                                                                                                                                                                                                                                                                              
--------------                                                                                                                                                                                                                                                                                              
             0                                                                                                                                                                                                                                                                                              

SQL> CREATE OR REPLACE FUNCTION tax(p_value IN NUMBER)
  2   RETURN NUMBER IS
  3  BEGIN
  4     RETURN (p_value * 0.08);
  5  END tax;
  6  /

Function created.

SQL> SELECT employee_id, last_name, salary, tax(salary)
  2  FROM   employees
  3  WHERE  department_id = 100;

EMPLOYEE_ID LAST_NAME                     SALARY TAX(SALARY)                                                                                                                                                                                                                                                
----------- ------------------------- ---------- -----------                                                                                                                                                                                                                                                
        108 Greenberg                   19339.01   1547.1208                                                                                                                                                                                                                                                
        109 Faviet                       13176.9    1054.152                                                                                                                                                                                                                                                
        110 Chen                        15253.14   1220.2512                                                                                                                                                                                                                                                
        111 Sciarra                     11273.57    901.8856                                                                                                                                                                                                                                                
        112 Urman                       11419.98    913.5984                                                                                                                                                                                                                                                
        113 Popp                        10102.29    808.1832                                                                                                                                                                                                                                                

6 rows selected.

SQL> SELECT employee_id, tax(salary)
  2  FROM   employees
  3  WHERE  tax(salary) > (SELECT MAX(tax(salary))
  4                        FROM employees
  5                        WHERE department_id = 30)
  6  ORDER BY tax(salary) DESC;

EMPLOYEE_ID TAX(SALARY)                                                                                                                                                                                                                                                                                     
----------- -----------                                                                                                                                                                                                                                                                                     
        145    1639.792                                                                                                                                                                                                                                                                                     
        146    1581.228                                                                                                                                                                                                                                                                                     
        108   1547.1208                                                                                                                                                                                                                                                                                     
        205   1406.4736                                                                                                                                                                                                                                                                                     
        147    1405.536                                                                                                                                                                                                                                                                                     
        168    1346.972                                                                                                                                                                                                                                                                                     

6 rows selected.

SQL> select employee_id,tax(salary) from employees where department_id=30;

EMPLOYEE_ID TAX(SALARY)                                                                                                                                                                                                                                                                                     
----------- -----------                                                                                                                                                                                                                                                                                     
        114    1288.408                                                                                                                                                                                                                                                                                     
        115    363.0968                                                                                                                                                                                                                                                                                     
        116    339.6712                                                                                                                                                                                                                                                                                     
        117    327.9584                                                                                                                                                                                                                                                                                     
        118    304.5328                                                                                                                                                                                                                                                                                     
        119      292.82                                                                                                                                                                                                                                                                                     

6 rows selected.

SQL> select employee_id,tax(salary) from employees where tax(salary)>1288;

EMPLOYEE_ID TAX(SALARY)                                                                                                                                                                                                                                                                                     
----------- -----------                                                                                                                                                                                                                                                                                     
        205   1406.4736                                                                                                                                                                                                                                                                                     
        108   1547.1208                                                                                                                                                                                                                                                                                     
        114    1288.408                                                                                                                                                                                                                                                                                     
        145    1639.792                                                                                                                                                                                                                                                                                     
        146    1581.228                                                                                                                                                                                                                                                                                     
        147    1405.536                                                                                                                                                                                                                                                                                     
        148    1288.408                                                                                                                                                                                                                                                                                     
        168    1346.972                                                                                                                                                                                                                                                                                     
        174    1288.408                                                                                                                                                                                                                                                                                     

9 rows selected.

SQL> exit
SQL> set lines 300
SQL> set pages 25
SQL> set serveroutput on
SQL> CREATE OR REPLACE FUNCTION dml_call_sql(p_sal NUMBER)
  2     RETURN NUMBER IS
  3  BEGIN
  4    INSERT INTO employees(employee_id, last_name, email,
  5                          hire_date, job_id, salary)
  6    VALUES(1, 'Frost', 'jfrost@company.com',
  7           SYSDATE, 'SA_MAN', p_sal);
  8    RETURN (p_sal + 100);
  9  END;
 10  /

Function created.

SQL> UPDATE employees
  2    SET salary = dml_call_sql(2000)
  3  WHERE employee_id = 170;

0 rows updated.

SQL> select * from employees where employee_id=170;

no rows selected

SQL> UPDATE employees
  2    SET salary = dml_call_sql(2000)
  3  WHERE employee_id = 100;
  SET salary = dml_call_sql(2000)
               *
ERROR at line 2:
ORA-04091: table HR.EMPLOYEES is mutating, trigger/function may not see it 
ORA-06512: at "HR.DML_CALL_SQL", line 4 


SQL> CREATE OR REPLACE FUNCTION dml_call_sql(p_sal NUMBER)
  2     RETURN NUMBER IS
  3  BEGIN
  4    INSERT INTO employees(employee_id, last_name, email,
  5                          hire_date, job_id, salary)
  6    VALUES(1, 'Frost', 'jfrost@company.com',
  7           SYSDATE, 'SA_MAN', p_sal);
  8    RETURN (p_sal + 100);
  9  END;
 10  /

Function created.

SQL> ed
Wrote file afiedt.buf

  1  CREATE OR REPLACE FUNCTION dml_call_sql(p_sal NUMBER)
  2     RETURN NUMBER IS
  3  sal number;
  4  BEGIN
  5    select salary into sal from employees where employee_id=100; 
  6    RETURN (p_sal + 100);
  7* END;
SQL> /

Function created.

SQL> UPDATE employees
  2    SET salary = dml_call_sql(2000)
  3  WHERE employee_id = 170;

0 rows updated.

SQL> ed
Wrote file afiedt.buf

  1  UPDATE employees
  2    SET salary = dml_call_sql(2000)
  3* WHERE employee_id = 110
SQL> /
  SET salary = dml_call_sql(2000)
               *
ERROR at line 2:
ORA-04091: table HR.EMPLOYEES is mutating, trigger/function may not see it 
ORA-06512: at "HR.DML_CALL_SQL", line 5 


SQL> CREATE OR REPLACE FUNCTION query_call_sql(p_a NUMBER) RETURN NUMBER IS
  2     v_s NUMBER;
  3  BEGIN
  4     SELECT salary INTO v_s FROM employees
  5     WHERE employee_id = 170;
  6     RETURN (v_s + p_a);
  7  END;
  8  /

Function created.

SQL> UPDATE employees SET salary = query_call_sql(100)
  2  WHERE employee_id = 170;

0 rows updated.

SQL> ed
Wrote file afiedt.buf

  1  UPDATE employees SET salary = query_call_sql(100)
  2* WHERE employee_id = 100
SQL> /
UPDATE employees SET salary = query_call_sql(100)
                              *
ERROR at line 1:
ORA-04091: table HR.EMPLOYEES is mutating, trigger/function may not see it 
ORA-06512: at "HR.QUERY_CALL_SQL", line 4 


SQL> CREATE OR REPLACE FUNCTION f(
  2    p_parameter_1 IN NUMBER DEFAULT 1,
  3    p_parameter_5 IN NUMBER DEFAULT 5)
  4  RETURN NUMBER
  5  IS
  6   v_var number;
  7  BEGIN
  8    v_var := p_parameter_1 + (p_parameter_5 * 2);
  9    RETURN v_var;
 10  END f;
 11  /

Function created.

SQL> SELECT f(p_parameter_5 => 10) FROM DUAL;

F(P_PARAMETER_5=>10)                                                                                                                                                                                                                                                                                        
--------------------                                                                                                                                                                                                                                                                                        
                  21                                                                                                                                                                                                                                                                                        

SQL> SELECT f(p_parameter_1 => 10) FROM DUAL;

F(P_PARAMETER_1=>10)                                                                                                                                                                                                                                                                                        
--------------------                                                                                                                                                                                                                                                                                        
                  20                                                                                                                                                                                                                                                                                        

SQL> SELECT f() FROM DUAL;

       F()                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
        11                                                                                                                                                                                                                                                                                                  

SQL> SELECT f(2,3) FROM DUAL;

    F(2,3)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         8                                                                                                                                                                                                                                                                                                  

SQL> DROP FUNCTION f;

Function dropped.

SQL> SELECT text
  2  FROM   user_source
  3  WHERE  type = 'FUNCTION'
  4  ORDER BY line;

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
FUNCTION tax(p_value IN NUMBER)                                                                                                                                                                                                                                                                             
FUNCTION query_call_sql(p_a NUMBER) RETURN NUMBER IS                                                                                                                                                                                                                                                        
FUNCTION mtr2yrd(p_m NUMBER) RETURN NUMBER IS                                                                                                                                                                                                                                                               
FUNCTION get_salCREATE OR REPLACE FUNCTION get_sal                                                                                                                                                                                                                                                          
FUNCTION get_sal                                                                                                                                                                                                                                                                                            
FUNCTION get_emp(p_emp_id NUMBER)                                                                                                                                                                                                                                                                           
FUNCTION emp_hire_date (p_emp_id NUMBER, fmt VARCHAR) RETURN VARCHAR                                                                                                                                                                                                                                        
FUNCTION dml_call_sql(p_sal NUMBER)                                                                                                                                                                                                                                                                         
FUNCTION del_rows(p_table_name VARCHAR2)                                                                                                                                                                                                                                                                    
FUNCTION delete_all_rows                                                                                                                                                                                                                                                                                    
FUNCTION check_sal (p_empno  employees.employee_id%TYPE) RETURN Boolean IS                                                                                                                                                                                                                                  
FUNCTION annual_sal( p_emp_id NUMBER)                                                                                                                                                                                                                                                                       
 RETURN NUMBER IS                                                                                                                                                                                                                                                                                           
   v_s NUMBER;                                                                                                                                                                                                                                                                                              
BEGIN                                                                                                                                                                                                                                                                                                       
 (p_id  employees.employee_id%TYPE) RETURN NUMBER IS                                                                                                                                                                                                                                                        
 (p_id  employees.employee_id%TYPE) RETURN NUMBER IS                                                                                                                                                                                                                                                        
RETURN employees%ROWTYPE IS                                                                                                                                                                                                                                                                                 
 RESULT_CACHE RELIES_ON (employees) IS                                                                                                                                                                                                                                                                      
   RETURN NUMBER IS                                                                                                                                                                                                                                                                                         
RETURN NUMBER IS                                                                                                                                                                                                                                                                                            
  (p_table_name VARCHAR2) RETURN NUMBER IS                                                                                                                                                                                                                                                                  

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 v_dept_id employees.department_id%TYPE;                                                                                                                                                                                                                                                                    
RETURN NUMBER IS                                                                                                                                                                                                                                                                                            
BEGIN                                                                                                                                                                                                                                                                                                       
BEGIN                                                                                                                                                                                                                                                                                                       
  RETURN (p_m * global_consts.c_meter_2_yard);                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                            
v_sal employees.salary%TYPE := 0;                                                                                                                                                                                                                                                                           
  v_stmt VARCHAR2(200);                                                                                                                                                                                                                                                                                     
 v_date_hired DATE;                                                                                                                                                                                                                                                                                         
sal number;                                                                                                                                                                                                                                                                                                 
BEGIN                                                                                                                                                                                                                                                                                                       
   v_cur_id INTEGER;                                                                                                                                                                                                                                                                                        
 v_sal     employees.salary%TYPE;                                                                                                                                                                                                                                                                           
  v_plsql varchar2(200) :=                                                                                                                                                                                                                                                                                  
   RETURN (p_value * 0.08);                                                                                                                                                                                                                                                                                 
   SELECT salary INTO v_s FROM employees                                                                                                                                                                                                                                                                    
END mtr2yrd;                                                                                                                                                                                                                                                                                                
v_sal employees.salary%TYPE := 0;                                                                                                                                                                                                                                                                           
BEGIN                                                                                                                                                                                                                                                                                                       
  v_emprec employees%ROWTYPE;                                                                                                                                                                                                                                                                               
BEGIN                                                                                                                                                                                                                                                                                                       
BEGIN                                                                                                                                                                                                                                                                                                       

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  EXECUTE IMMEDIATE 'DELETE FROM '|| p_table_name;                                                                                                                                                                                                                                                          
   v_rows_del    NUMBER;                                                                                                                                                                                                                                                                                    
 v_avg_sal employees.salary%TYPE;                                                                                                                                                                                                                                                                           
    'DECLARE '||                                                                                                                                                                                                                                                                                            
END tax;                                                                                                                                                                                                                                                                                                    
   WHERE employee_id = 170;                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                            
  SELECT salary                                                                                                                                                                                                                                                                                             
BEGIN                                                                                                                                                                                                                                                                                                       
  SELECT hire_date INTO v_date_hired                                                                                                                                                                                                                                                                        
  select salary into sal from employees where employee_id=100;                                                                                                                                                                                                                                              
  RETURN SQL%ROWCOUNT;                                                                                                                                                                                                                                                                                      
BEGIN                                                                                                                                                                                                                                                                                                       
BEGIN                                                                                                                                                                                                                                                                                                       
    ' rec_emp employees%ROWTYPE; '||                                                                                                                                                                                                                                                                        
   RETURN (v_s + p_a);                                                                                                                                                                                                                                                                                      
BEGIN                                                                                                                                                                                                                                                                                                       
  INTO   v_sal                                                                                                                                                                                                                                                                                              
  v_stmt := 'SELECT * FROM employees ' ||                                                                                                                                                                                                                                                                   
  FROM employees                                                                                                                                                                                                                                                                                            
  RETURN (p_sal + 100);                                                                                                                                                                                                                                                                                     
END;                                                                                                                                                                                                                                                                                                        

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  v_cur_id := DBMS_SQL.OPEN_CURSOR;                                                                                                                                                                                                                                                                         
 SELECT salary,department_id INTO v_sal,v_dept_id FROM employees                                                                                                                                                                                                                                            
    'BEGIN '||                                                                                                                                                                                                                                                                                              
END;                                                                                                                                                                                                                                                                                                        
  SELECT salary                                                                                                                                                                                                                                                                                             
  FROM   employees                                                                                                                                                                                                                                                                                          
          'WHERE employee_id = :id';                                                                                                                                                                                                                                                                        
  WHERE employee_id = p_emp_id;                                                                                                                                                                                                                                                                             
END;                                                                                                                                                                                                                                                                                                        
  DBMS_SQL.PARSE(v_cur_id,'DELETE FROM '|| p_table_name, DBMS_SQL.NATIVE);                                                                                                                                                                                                                                  
 WHERE employee_id=p_empno;                                                                                                                                                                                                                                                                                 
    ' rec_emp := get_emp(:empid); ' ||                                                                                                                                                                                                                                                                      
  WHERE  employee_id = p_id;                                                                                                                                                                                                                                                                                
  EXECUTE IMMEDIATE v_stmt INTO v_emprec USING p_emp_id;                                                                                                                                                                                                                                                    
    ' :res := rec_emp.salary  * 12; ' ||                                                                                                                                                                                                                                                                    
 SELECT avg(salary) INTO v_avg_sal FROM employees WHERE department_id=v_dept_id;                                                                                                                                                                                                                            
  RETURN to_char(v_date_hired, fmt);                                                                                                                                                                                                                                                                        
  v_rows_del := DBMS_SQL.EXECUTE (v_cur_id);                                                                                                                                                                                                                                                                
  INTO   v_sal                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                            
  DBMS_SQL.CLOSE_CURSOR(v_cur_id);                                                                                                                                                                                                                                                                          
 IF v_sal > v_avg_sal THEN                                                                                                                                                                                                                                                                                  

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  FROM   employees                                                                                                                                                                                                                                                                                          
    'END;';                                                                                                                                                                                                                                                                                                 
END;                                                                                                                                                                                                                                                                                                        
  RETURN v_sal;                                                                                                                                                                                                                                                                                             
  RETURN v_emprec;                                                                                                                                                                                                                                                                                          
exception                                                                                                                                                                                                                                                                                                   
  WHERE  employee_id = p_id;                                                                                                                                                                                                                                                                                
  RETURN v_rows_del;                                                                                                                                                                                                                                                                                        
  v_result NUMBER;                                                                                                                                                                                                                                                                                          
  RETURN TRUE;                                                                                                                                                                                                                                                                                              
 ELSE                                                                                                                                                                                                                                                                                                       
END;                                                                                                                                                                                                                                                                                                        
BEGIN                                                                                                                                                                                                                                                                                                       
END;                                                                                                                                                                                                                                                                                                        
  RETURN v_sal;                                                                                                                                                                                                                                                                                             
when others then                                                                                                                                                                                                                                                                                            
return 0;                                                                                                                                                                                                                                                                                                   
  RETURN FALSE;                                                                                                                                                                                                                                                                                             
 EXECUTE IMMEDIATE v_plsql                                                                                                                                                                                                                                                                                  
END get_sal;                                                                                                                                                                                                                                                                                                
 END IF;                                                                                                                                                                                                                                                                                                    
         USING IN p_emp_id, OUT v_result;                                                                                                                                                                                                                                                                   

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
END get_sal;                                                                                                                                                                                                                                                                                                
  RETURN v_result;                                                                                                                                                                                                                                                                                          
EXCEPTION                                                                                                                                                                                                                                                                                                   
  WHEN NO_DATA_FOUND THEN                                                                                                                                                                                                                                                                                   
END;                                                                                                                                                                                                                                                                                                        
   RETURN NULL;                                                                                                                                                                                                                                                                                             
END;                                                                                                                                                                                                                                                                                                        

117 rows selected.

SQL> ed
Wrote file afiedt.buf

  1  SELECT text
  2  FROM   user_source
  3  WHERE  type = 'FUNCTION' and 
  4* ORDER BY line
SQL> desc user_source;
 Name                                                                                                                                                                          Null?    Type
 ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------- --------------------------------------------------------------------------------------------------------------------
 NAME                                                                                                                                                                                   VARCHAR2(30)
 TYPE                                                                                                                                                                                   VARCHAR2(12)
 LINE                                                                                                                                                                                   NUMBER
 TEXT                                                                                                                                                                                   VARCHAR2(4000)

SQL> SELECT text
  2  FROM   user_source
  3  WHERE  type = 'FUNCTION'
  4  ORDER BY line;

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
FUNCTION tax(p_value IN NUMBER)                                                                                                                                                                                                                                                                             
FUNCTION query_call_sql(p_a NUMBER) RETURN NUMBER IS                                                                                                                                                                                                                                                        
FUNCTION mtr2yrd(p_m NUMBER) RETURN NUMBER IS                                                                                                                                                                                                                                                               
FUNCTION get_salCREATE OR REPLACE FUNCTION get_sal                                                                                                                                                                                                                                                          
FUNCTION get_sal                                                                                                                                                                                                                                                                                            
FUNCTION get_emp(p_emp_id NUMBER)                                                                                                                                                                                                                                                                           
FUNCTION emp_hire_date (p_emp_id NUMBER, fmt VARCHAR) RETURN VARCHAR                                                                                                                                                                                                                                        
FUNCTION dml_call_sql(p_sal NUMBER)                                                                                                                                                                                                                                                                         
FUNCTION del_rows(p_table_name VARCHAR2)                                                                                                                                                                                                                                                                    
FUNCTION delete_all_rows                                                                                                                                                                                                                                                                                    
FUNCTION check_sal (p_empno  employees.employee_id%TYPE) RETURN Boolean IS                                                                                                                                                                                                                                  
FUNCTION annual_sal( p_emp_id NUMBER)                                                                                                                                                                                                                                                                       
 RETURN NUMBER IS                                                                                                                                                                                                                                                                                           
   v_s NUMBER;                                                                                                                                                                                                                                                                                              
BEGIN                                                                                                                                                                                                                                                                                                       
 (p_id  employees.employee_id%TYPE) RETURN NUMBER IS                                                                                                                                                                                                                                                        
 (p_id  employees.employee_id%TYPE) RETURN NUMBER IS                                                                                                                                                                                                                                                        
RETURN employees%ROWTYPE IS                                                                                                                                                                                                                                                                                 
 RESULT_CACHE RELIES_ON (employees) IS                                                                                                                                                                                                                                                                      
   RETURN NUMBER IS                                                                                                                                                                                                                                                                                         
RETURN NUMBER IS                                                                                                                                                                                                                                                                                            
  (p_table_name VARCHAR2) RETURN NUMBER IS                                                                                                                                                                                                                                                                  

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 v_dept_id employees.department_id%TYPE;                                                                                                                                                                                                                                                                    
RETURN NUMBER IS                                                                                                                                                                                                                                                                                            
BEGIN                                                                                                                                                                                                                                                                                                       
BEGIN                                                                                                                                                                                                                                                                                                       
  RETURN (p_m * global_consts.c_meter_2_yard);                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                            
v_sal employees.salary%TYPE := 0;                                                                                                                                                                                                                                                                           
  v_stmt VARCHAR2(200);                                                                                                                                                                                                                                                                                     
 v_date_hired DATE;                                                                                                                                                                                                                                                                                         
sal number;                                                                                                                                                                                                                                                                                                 
BEGIN                                                                                                                                                                                                                                                                                                       
   v_cur_id INTEGER;                                                                                                                                                                                                                                                                                        
 v_sal     employees.salary%TYPE;                                                                                                                                                                                                                                                                           
  v_plsql varchar2(200) :=                                                                                                                                                                                                                                                                                  
   RETURN (p_value * 0.08);                                                                                                                                                                                                                                                                                 
   SELECT salary INTO v_s FROM employees                                                                                                                                                                                                                                                                    
END mtr2yrd;                                                                                                                                                                                                                                                                                                
v_sal employees.salary%TYPE := 0;                                                                                                                                                                                                                                                                           
BEGIN                                                                                                                                                                                                                                                                                                       
  v_emprec employees%ROWTYPE;                                                                                                                                                                                                                                                                               
BEGIN                                                                                                                                                                                                                                                                                                       
BEGIN                                                                                                                                                                                                                                                                                                       

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  EXECUTE IMMEDIATE 'DELETE FROM '|| p_table_name;                                                                                                                                                                                                                                                          
   v_rows_del    NUMBER;                                                                                                                                                                                                                                                                                    
 v_avg_sal employees.salary%TYPE;                                                                                                                                                                                                                                                                           
    'DECLARE '||                                                                                                                                                                                                                                                                                            
END tax;                                                                                                                                                                                                                                                                                                    
   WHERE employee_id = 170;                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                            
  SELECT salary                                                                                                                                                                                                                                                                                             
BEGIN                                                                                                                                                                                                                                                                                                       
  SELECT hire_date INTO v_date_hired                                                                                                                                                                                                                                                                        
  select salary into sal from employees where employee_id=100;                                                                                                                                                                                                                                              
  RETURN SQL%ROWCOUNT;                                                                                                                                                                                                                                                                                      
BEGIN                                                                                                                                                                                                                                                                                                       
BEGIN                                                                                                                                                                                                                                                                                                       
    ' rec_emp employees%ROWTYPE; '||                                                                                                                                                                                                                                                                        
   RETURN (v_s + p_a);                                                                                                                                                                                                                                                                                      
BEGIN                                                                                                                                                                                                                                                                                                       
  INTO   v_sal                                                                                                                                                                                                                                                                                              
  v_stmt := 'SELECT * FROM employees ' ||                                                                                                                                                                                                                                                                   
  FROM employees                                                                                                                                                                                                                                                                                            
  RETURN (p_sal + 100);                                                                                                                                                                                                                                                                                     
END;                                                                                                                                                                                                                                                                                                        

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  v_cur_id := DBMS_SQL.OPEN_CURSOR;                                                                                                                                                                                                                                                                         
 SELECT salary,department_id INTO v_sal,v_dept_id FROM employees                                                                                                                                                                                                                                            
    'BEGIN '||                                                                                                                                                                                                                                                                                              
END;                                                                                                                                                                                                                                                                                                        
  SELECT salary                                                                                                                                                                                                                                                                                             
  FROM   employees                                                                                                                                                                                                                                                                                          
          'WHERE employee_id = :id';                                                                                                                                                                                                                                                                        
  WHERE employee_id = p_emp_id;                                                                                                                                                                                                                                                                             
END;                                                                                                                                                                                                                                                                                                        
  DBMS_SQL.PARSE(v_cur_id,'DELETE FROM '|| p_table_name, DBMS_SQL.NATIVE);                                                                                                                                                                                                                                  
 WHERE employee_id=p_empno;                                                                                                                                                                                                                                                                                 
    ' rec_emp := get_emp(:empid); ' ||                                                                                                                                                                                                                                                                      
  WHERE  employee_id = p_id;                                                                                                                                                                                                                                                                                
  EXECUTE IMMEDIATE v_stmt INTO v_emprec USING p_emp_id;                                                                                                                                                                                                                                                    
    ' :res := rec_emp.salary  * 12; ' ||                                                                                                                                                                                                                                                                    
 SELECT avg(salary) INTO v_avg_sal FROM employees WHERE department_id=v_dept_id;                                                                                                                                                                                                                            
  RETURN to_char(v_date_hired, fmt);                                                                                                                                                                                                                                                                        
  v_rows_del := DBMS_SQL.EXECUTE (v_cur_id);                                                                                                                                                                                                                                                                
  INTO   v_sal                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                            
  DBMS_SQL.CLOSE_CURSOR(v_cur_id);                                                                                                                                                                                                                                                                          
 IF v_sal > v_avg_sal THEN                                                                                                                                                                                                                                                                                  

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  FROM   employees                                                                                                                                                                                                                                                                                          
    'END;';                                                                                                                                                                                                                                                                                                 
END;                                                                                                                                                                                                                                                                                                        
  RETURN v_sal;                                                                                                                                                                                                                                                                                             
  RETURN v_emprec;                                                                                                                                                                                                                                                                                          
exception                                                                                                                                                                                                                                                                                                   
  WHERE  employee_id = p_id;                                                                                                                                                                                                                                                                                
  RETURN v_rows_del;                                                                                                                                                                                                                                                                                        
  v_result NUMBER;                                                                                                                                                                                                                                                                                          
  RETURN TRUE;                                                                                                                                                                                                                                                                                              
 ELSE                                                                                                                                                                                                                                                                                                       
END;                                                                                                                                                                                                                                                                                                        
BEGIN                                                                                                                                                                                                                                                                                                       
END;                                                                                                                                                                                                                                                                                                        
  RETURN v_sal;                                                                                                                                                                                                                                                                                             
when others then                                                                                                                                                                                                                                                                                            
return 0;                                                                                                                                                                                                                                                                                                   
  RETURN FALSE;                                                                                                                                                                                                                                                                                             
 EXECUTE IMMEDIATE v_plsql                                                                                                                                                                                                                                                                                  
END get_sal;                                                                                                                                                                                                                                                                                                
 END IF;                                                                                                                                                                                                                                                                                                    
         USING IN p_emp_id, OUT v_result;                                                                                                                                                                                                                                                                   

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
END get_sal;                                                                                                                                                                                                                                                                                                
  RETURN v_result;                                                                                                                                                                                                                                                                                          
EXCEPTION                                                                                                                                                                                                                                                                                                   
  WHEN NO_DATA_FOUND THEN                                                                                                                                                                                                                                                                                   
END;                                                                                                                                                                                                                                                                                                        
   RETURN NULL;                                                                                                                                                                                                                                                                                             
END;                                                                                                                                                                                                                                                                                                        

117 rows selected.

SQL> ed
Wrote file afiedt.buf

  1  SELECT text
  2  FROM   user_source
  3  WHERE  type = 'FUNCTION' and name='get_sal'
  4* ORDER BY line
SQL> /

no rows selected

SQL> ed
Wrote file afiedt.buf

  1  SELECT text
  2  FROM   user_source
  3  WHERE  type = 'FUNCTION' and name='QUERY_CALL_SQL'
  4* ORDER BY line
SQL> /

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
FUNCTION query_call_sql(p_a NUMBER) RETURN NUMBER IS                                                                                                                                                                                                                                                        
   v_s NUMBER;                                                                                                                                                                                                                                                                                              
BEGIN                                                                                                                                                                                                                                                                                                       
   SELECT salary INTO v_s FROM employees                                                                                                                                                                                                                                                                    
   WHERE employee_id = 170;                                                                                                                                                                                                                                                                                 
   RETURN (v_s + p_a);                                                                                                                                                                                                                                                                                      
END;                                                                                                                                                                                                                                                                                                        

7 rows selected.

SQL> SELECT NAME FROM USER_SOURCE WHERE TYPE='FUNCTION';

NAME                                                                                                                                                                                                                                                                                                        
------------------------------                                                                                                                                                                                                                                                                              
TAX                                                                                                                                                                                                                                                                                                         
TAX                                                                                                                                                                                                                                                                                                         
TAX                                                                                                                                                                                                                                                                                                         
TAX                                                                                                                                                                                                                                                                                                         
TAX                                                                                                                                                                                                                                                                                                         
QUERY_CALL_SQL                                                                                                                                                                                                                                                                                              
QUERY_CALL_SQL                                                                                                                                                                                                                                                                                              
QUERY_CALL_SQL                                                                                                                                                                                                                                                                                              
QUERY_CALL_SQL                                                                                                                                                                                                                                                                                              
QUERY_CALL_SQL                                                                                                                                                                                                                                                                                              
QUERY_CALL_SQL                                                                                                                                                                                                                                                                                              
QUERY_CALL_SQL                                                                                                                                                                                                                                                                                              
MTR2YRD                                                                                                                                                                                                                                                                                                     
MTR2YRD                                                                                                                                                                                                                                                                                                     
MTR2YRD                                                                                                                                                                                                                                                                                                     
MTR2YRD                                                                                                                                                                                                                                                                                                     
GET_SALCREATE                                                                                                                                                                                                                                                                                               
GET_SALCREATE                                                                                                                                                                                                                                                                                               
GET_SALCREATE                                                                                                                                                                                                                                                                                               
GET_SALCREATE                                                                                                                                                                                                                                                                                               
GET_SALCREATE                                                                                                                                                                                                                                                                                               
GET_SALCREATE                                                                                                                                                                                                                                                                                               

NAME                                                                                                                                                                                                                                                                                                        
------------------------------                                                                                                                                                                                                                                                                              
GET_SALCREATE                                                                                                                                                                                                                                                                                               
GET_SALCREATE                                                                                                                                                                                                                                                                                               
GET_SALCREATE                                                                                                                                                                                                                                                                                               
GET_SALCREATE                                                                                                                                                                                                                                                                                               
GET_SALCREATE                                                                                                                                                                                                                                                                                               
GET_SALCREATE                                                                                                                                                                                                                                                                                               
GET_SAL                                                                                                                                                                                                                                                                                                     
GET_SAL                                                                                                                                                                                                                                                                                                     
GET_SAL                                                                                                                                                                                                                                                                                                     
GET_SAL                                                                                                                                                                                                                                                                                                     
GET_SAL                                                                                                                                                                                                                                                                                                     
GET_SAL                                                                                                                                                                                                                                                                                                     
GET_SAL                                                                                                                                                                                                                                                                                                     
GET_SAL                                                                                                                                                                                                                                                                                                     
GET_SAL                                                                                                                                                                                                                                                                                                     
GET_SAL                                                                                                                                                                                                                                                                                                     
GET_SAL                                                                                                                                                                                                                                                                                                     
GET_SAL                                                                                                                                                                                                                                                                                                     
GET_SAL                                                                                                                                                                                                                                                                                                     
GET_EMP                                                                                                                                                                                                                                                                                                     
GET_EMP                                                                                                                                                                                                                                                                                                     
GET_EMP                                                                                                                                                                                                                                                                                                     

NAME                                                                                                                                                                                                                                                                                                        
------------------------------                                                                                                                                                                                                                                                                              
GET_EMP                                                                                                                                                                                                                                                                                                     
GET_EMP                                                                                                                                                                                                                                                                                                     
GET_EMP                                                                                                                                                                                                                                                                                                     
GET_EMP                                                                                                                                                                                                                                                                                                     
GET_EMP                                                                                                                                                                                                                                                                                                     
GET_EMP                                                                                                                                                                                                                                                                                                     
GET_EMP                                                                                                                                                                                                                                                                                                     
GET_EMP                                                                                                                                                                                                                                                                                                     
EMP_HIRE_DATE                                                                                                                                                                                                                                                                                               
EMP_HIRE_DATE                                                                                                                                                                                                                                                                                               
EMP_HIRE_DATE                                                                                                                                                                                                                                                                                               
EMP_HIRE_DATE                                                                                                                                                                                                                                                                                               
EMP_HIRE_DATE                                                                                                                                                                                                                                                                                               
EMP_HIRE_DATE                                                                                                                                                                                                                                                                                               
EMP_HIRE_DATE                                                                                                                                                                                                                                                                                               
EMP_HIRE_DATE                                                                                                                                                                                                                                                                                               
EMP_HIRE_DATE                                                                                                                                                                                                                                                                                               
DML_CALL_SQL                                                                                                                                                                                                                                                                                                
DML_CALL_SQL                                                                                                                                                                                                                                                                                                
DML_CALL_SQL                                                                                                                                                                                                                                                                                                
DML_CALL_SQL                                                                                                                                                                                                                                                                                                
DML_CALL_SQL                                                                                                                                                                                                                                                                                                

NAME                                                                                                                                                                                                                                                                                                        
------------------------------                                                                                                                                                                                                                                                                              
DML_CALL_SQL                                                                                                                                                                                                                                                                                                
DML_CALL_SQL                                                                                                                                                                                                                                                                                                
DEL_ROWS                                                                                                                                                                                                                                                                                                    
DEL_ROWS                                                                                                                                                                                                                                                                                                    
DEL_ROWS                                                                                                                                                                                                                                                                                                    
DEL_ROWS                                                                                                                                                                                                                                                                                                    
DEL_ROWS                                                                                                                                                                                                                                                                                                    
DEL_ROWS                                                                                                                                                                                                                                                                                                    
DELETE_ALL_ROWS                                                                                                                                                                                                                                                                                             
DELETE_ALL_ROWS                                                                                                                                                                                                                                                                                             
DELETE_ALL_ROWS                                                                                                                                                                                                                                                                                             
DELETE_ALL_ROWS                                                                                                                                                                                                                                                                                             
DELETE_ALL_ROWS                                                                                                                                                                                                                                                                                             
DELETE_ALL_ROWS                                                                                                                                                                                                                                                                                             
DELETE_ALL_ROWS                                                                                                                                                                                                                                                                                             
DELETE_ALL_ROWS                                                                                                                                                                                                                                                                                             
DELETE_ALL_ROWS                                                                                                                                                                                                                                                                                             
DELETE_ALL_ROWS                                                                                                                                                                                                                                                                                             
DELETE_ALL_ROWS                                                                                                                                                                                                                                                                                             
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   

NAME                                                                                                                                                                                                                                                                                                        
------------------------------                                                                                                                                                                                                                                                                              
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   
CHECK_SAL                                                                                                                                                                                                                                                                                                   
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  

NAME                                                                                                                                                                                                                                                                                                        
------------------------------                                                                                                                                                                                                                                                                              
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  
ANNUAL_SAL                                                                                                                                                                                                                                                                                                  

117 rows selected.

SQL> SELECT text
  2  FROM   user_source
  3  WHERE  type = 'FUNCTION'
  4  ORDER BY line;

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
FUNCTION tax(p_value IN NUMBER)                                                                                                                                                                                                                                                                             
FUNCTION query_call_sql(p_a NUMBER) RETURN NUMBER IS                                                                                                                                                                                                                                                        
FUNCTION mtr2yrd(p_m NUMBER) RETURN NUMBER IS                                                                                                                                                                                                                                                               
FUNCTION get_salCREATE OR REPLACE FUNCTION get_sal                                                                                                                                                                                                                                                          
FUNCTION get_sal                                                                                                                                                                                                                                                                                            
FUNCTION get_emp(p_emp_id NUMBER)                                                                                                                                                                                                                                                                           
FUNCTION emp_hire_date (p_emp_id NUMBER, fmt VARCHAR) RETURN VARCHAR                                                                                                                                                                                                                                        
FUNCTION dml_call_sql(p_sal NUMBER)                                                                                                                                                                                                                                                                         
FUNCTION del_rows(p_table_name VARCHAR2)                                                                                                                                                                                                                                                                    
FUNCTION delete_all_rows                                                                                                                                                                                                                                                                                    
FUNCTION check_sal (p_empno  employees.employee_id%TYPE) RETURN Boolean IS                                                                                                                                                                                                                                  
FUNCTION annual_sal( p_emp_id NUMBER)                                                                                                                                                                                                                                                                       
 RETURN NUMBER IS                                                                                                                                                                                                                                                                                           
   v_s NUMBER;                                                                                                                                                                                                                                                                                              
BEGIN                                                                                                                                                                                                                                                                                                       
 (p_id  employees.employee_id%TYPE) RETURN NUMBER IS                                                                                                                                                                                                                                                        
 (p_id  employees.employee_id%TYPE) RETURN NUMBER IS                                                                                                                                                                                                                                                        
RETURN employees%ROWTYPE IS                                                                                                                                                                                                                                                                                 
 RESULT_CACHE RELIES_ON (employees) IS                                                                                                                                                                                                                                                                      
   RETURN NUMBER IS                                                                                                                                                                                                                                                                                         
RETURN NUMBER IS                                                                                                                                                                                                                                                                                            
  (p_table_name VARCHAR2) RETURN NUMBER IS                                                                                                                                                                                                                                                                  

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 v_dept_id employees.department_id%TYPE;                                                                                                                                                                                                                                                                    
RETURN NUMBER IS                                                                                                                                                                                                                                                                                            
BEGIN                                                                                                                                                                                                                                                                                                       
BEGIN                                                                                                                                                                                                                                                                                                       
  RETURN (p_m * global_consts.c_meter_2_yard);                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                            
v_sal employees.salary%TYPE := 0;                                                                                                                                                                                                                                                                           
  v_stmt VARCHAR2(200);                                                                                                                                                                                                                                                                                     
 v_date_hired DATE;                                                                                                                                                                                                                                                                                         
sal number;                                                                                                                                                                                                                                                                                                 
BEGIN                                                                                                                                                                                                                                                                                                       
   v_cur_id INTEGER;                                                                                                                                                                                                                                                                                        
 v_sal     employees.salary%TYPE;                                                                                                                                                                                                                                                                           
  v_plsql varchar2(200) :=                                                                                                                                                                                                                                                                                  
   RETURN (p_value * 0.08);                                                                                                                                                                                                                                                                                 
   SELECT salary INTO v_s FROM employees                                                                                                                                                                                                                                                                    
END mtr2yrd;                                                                                                                                                                                                                                                                                                
v_sal employees.salary%TYPE := 0;                                                                                                                                                                                                                                                                           
BEGIN                                                                                                                                                                                                                                                                                                       
  v_emprec employees%ROWTYPE;                                                                                                                                                                                                                                                                               
BEGIN                                                                                                                                                                                                                                                                                                       
BEGIN                                                                                                                                                                                                                                                                                                       

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  EXECUTE IMMEDIATE 'DELETE FROM '|| p_table_name;                                                                                                                                                                                                                                                          
   v_rows_del    NUMBER;                                                                                                                                                                                                                                                                                    
 v_avg_sal employees.salary%TYPE;                                                                                                                                                                                                                                                                           
    'DECLARE '||                                                                                                                                                                                                                                                                                            
END tax;                                                                                                                                                                                                                                                                                                    
   WHERE employee_id = 170;                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                            
  SELECT salary                                                                                                                                                                                                                                                                                             
BEGIN                                                                                                                                                                                                                                                                                                       
  SELECT hire_date INTO v_date_hired                                                                                                                                                                                                                                                                        
  select salary into sal from employees where employee_id=100;                                                                                                                                                                                                                                              
  RETURN SQL%ROWCOUNT;                                                                                                                                                                                                                                                                                      
BEGIN                                                                                                                                                                                                                                                                                                       
BEGIN                                                                                                                                                                                                                                                                                                       
    ' rec_emp employees%ROWTYPE; '||                                                                                                                                                                                                                                                                        
   RETURN (v_s + p_a);                                                                                                                                                                                                                                                                                      
BEGIN                                                                                                                                                                                                                                                                                                       
  INTO   v_sal                                                                                                                                                                                                                                                                                              
  v_stmt := 'SELECT * FROM employees ' ||                                                                                                                                                                                                                                                                   
  FROM employees                                                                                                                                                                                                                                                                                            
  RETURN (p_sal + 100);                                                                                                                                                                                                                                                                                     
END;                                                                                                                                                                                                                                                                                                        

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  v_cur_id := DBMS_SQL.OPEN_CURSOR;                                                                                                                                                                                                                                                                         
 SELECT salary,department_id INTO v_sal,v_dept_id FROM employees                                                                                                                                                                                                                                            
    'BEGIN '||                                                                                                                                                                                                                                                                                              
END;                                                                                                                                                                                                                                                                                                        
  SELECT salary                                                                                                                                                                                                                                                                                             
  FROM   employees                                                                                                                                                                                                                                                                                          
          'WHERE employee_id = :id';                                                                                                                                                                                                                                                                        
  WHERE employee_id = p_emp_id;                                                                                                                                                                                                                                                                             
END;                                                                                                                                                                                                                                                                                                        
  DBMS_SQL.PARSE(v_cur_id,'DELETE FROM '|| p_table_name, DBMS_SQL.NATIVE);                                                                                                                                                                                                                                  
 WHERE employee_id=p_empno;                                                                                                                                                                                                                                                                                 
    ' rec_emp := get_emp(:empid); ' ||                                                                                                                                                                                                                                                                      
  WHERE  employee_id = p_id;                                                                                                                                                                                                                                                                                
  EXECUTE IMMEDIATE v_stmt INTO v_emprec USING p_emp_id;                                                                                                                                                                                                                                                    
    ' :res := rec_emp.salary  * 12; ' ||                                                                                                                                                                                                                                                                    
 SELECT avg(salary) INTO v_avg_sal FROM employees WHERE department_id=v_dept_id;                                                                                                                                                                                                                            
  RETURN to_char(v_date_hired, fmt);                                                                                                                                                                                                                                                                        
  v_rows_del := DBMS_SQL.EXECUTE (v_cur_id);                                                                                                                                                                                                                                                                
  INTO   v_sal                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                            
  DBMS_SQL.CLOSE_CURSOR(v_cur_id);                                                                                                                                                                                                                                                                          
 IF v_sal > v_avg_sal THEN                                                                                                                                                                                                                                                                                  

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  FROM   employees                                                                                                                                                                                                                                                                                          
    'END;';                                                                                                                                                                                                                                                                                                 
END;                                                                                                                                                                                                                                                                                                        
  RETURN v_sal;                                                                                                                                                                                                                                                                                             
  RETURN v_emprec;                                                                                                                                                                                                                                                                                          
exception                                                                                                                                                                                                                                                                                                   
  WHERE  employee_id = p_id;                                                                                                                                                                                                                                                                                
  RETURN v_rows_del;                                                                                                                                                                                                                                                                                        
  v_result NUMBER;                                                                                                                                                                                                                                                                                          
  RETURN TRUE;                                                                                                                                                                                                                                                                                              
 ELSE                                                                                                                                                                                                                                                                                                       
END;                                                                                                                                                                                                                                                                                                        
BEGIN                                                                                                                                                                                                                                                                                                       
END;                                                                                                                                                                                                                                                                                                        
  RETURN v_sal;                                                                                                                                                                                                                                                                                             
when others then                                                                                                                                                                                                                                                                                            
return 0;                                                                                                                                                                                                                                                                                                   
  RETURN FALSE;                                                                                                                                                                                                                                                                                             
 EXECUTE IMMEDIATE v_plsql                                                                                                                                                                                                                                                                                  
END get_sal;                                                                                                                                                                                                                                                                                                
 END IF;                                                                                                                                                                                                                                                                                                    
         USING IN p_emp_id, OUT v_result;                                                                                                                                                                                                                                                                   

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
END get_sal;                                                                                                                                                                                                                                                                                                
  RETURN v_result;                                                                                                                                                                                                                                                                                          
EXCEPTION                                                                                                                                                                                                                                                                                                   
  WHEN NO_DATA_FOUND THEN                                                                                                                                                                                                                                                                                   
END;                                                                                                                                                                                                                                                                                                        
   RETURN NULL;                                                                                                                                                                                                                                                                                             
END;                                                                                                                                                                                                                                                                                                        

117 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT text
  2  FROM   user_source
  3  WHERE  type = 'FUNCTION' AND NAME='GET_SAL'
  4* ORDER BY line
SQL> /

TEXT                                                                                                                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
FUNCTION get_sal                                                                                                                                                                                                                                                                                            
 (p_id  employees.employee_id%TYPE) RETURN NUMBER IS                                                                                                                                                                                                                                                        
v_sal employees.salary%TYPE := 0;                                                                                                                                                                                                                                                                           
BEGIN                                                                                                                                                                                                                                                                                                       
  SELECT salary                                                                                                                                                                                                                                                                                             
  INTO   v_sal                                                                                                                                                                                                                                                                                              
  FROM   employees                                                                                                                                                                                                                                                                                          
  WHERE  employee_id = p_id;                                                                                                                                                                                                                                                                                
  RETURN v_sal;                                                                                                                                                                                                                                                                                             
exception                                                                                                                                                                                                                                                                                                   
when others then                                                                                                                                                                                                                                                                                            
return 0;                                                                                                                                                                                                                                                                                                   
END get_sal;                                                                                                                                                                                                                                                                                                

13 rows selected.

SQL> CREATE OR REPLACE PROCEDURE emp_list
  2  (p_maxrows IN NUMBER)
  3  IS
  4  CURSOR cur_emp IS
  5    SELECT d.department_name, e.employee_id, e.last_name,
  6           e.salary, e.commission_pct
  7    FROM  departments d, employees e
  8    WHERE d.department_id = e.department_id;
  9    rec_emp cur_emp%ROWTYPE;
 10    TYPE emp_tab_type IS TABLE OF cur_emp%ROWTYPE INDEX BY BINARY_INTEGER;
 11    emp_tab emp_tab_type;
 12  i NUMBER := 1;
 13  v_city VARCHAR2(30);
 14  BEGIN
 15    OPEN cur_emp;
 16    FETCH cur_emp INTO rec_emp;
 17    emp_tab(i) := rec_emp;
 18    WHILE (cur_emp%FOUND) AND (i <= p_maxrows) LOOP
 19       i := i + 1;
 20       FETCH cur_emp INTO rec_emp;
 21       emp_tab(i) := rec_emp;
 22       v_city := get_location (rec_emp.department_name);
 23       dbms_output.put_line('Employee ' || rec_emp.last_name ||
 24         ' works in ' || v_city );
 25    END LOOP;
 26    CLOSE cur_emp;
 27    FOR j IN REVERSE 1..i LOOP
 28       DBMS_OUTPUT.PUT_LINE(emp_tab(j).last_name);
 29    END LOOP;
 30  END emp_list;
 31  /

Warning: Procedure created with compilation errors.

SQL> SHOW ERRORS
Errors for PROCEDURE EMP_LIST:

LINE/COL ERROR                                                                                                                                                                                                                                                                                              
-------- -----------------------------------------------------------------                                                                                                                                                                                                                                  
22/6     PL/SQL: Statement ignored                                                                                                                                                                                                                                                                          
22/16    PLS-00201: identifier 'GET_LOCATION' must be declared                                                                                                                                                                                                                                              
SQL> CREATE OR REPLACE FUNCTION get_location
  2  ( p_deptname IN VARCHAR2) RETURN VARCHAR2
  3  AS
  4    v_loc_id NUMBER;
  5    v_city   VARCHAR2(30);
  6  BEGIN
  7    SELECT d.location_id, l.city INTO v_loc_id, v_city
  8    FROM departments d, locations l
  9    WHERE upper(department_name) = upper(p_deptname)
 10    and d.location_id = l.location_id;
 11    RETURN v_city;
 12  END GET_LOCATION;
 13  /

Function created.

SQL> CREATE OR REPLACE PROCEDURE emp_list
  2  (p_maxrows IN NUMBER)
  3  IS
  4  CURSOR cur_emp IS
  5    SELECT d.department_name, e.employee_id, e.last_name,
  6           e.salary, e.commission_pct
  7    FROM  departments d, employees e
  8    WHERE d.department_id = e.department_id;
  9    rec_emp cur_emp%ROWTYPE;
 10    TYPE emp_tab_type IS TABLE OF cur_emp%ROWTYPE INDEX BY BINARY_INTEGER;
 11    emp_tab emp_tab_type;
 12  i NUMBER := 1;
 13  v_city VARCHAR2(30);
 14  BEGIN
 15    OPEN cur_emp;
 16    FETCH cur_emp INTO rec_emp;
 17    emp_tab(i) := rec_emp;
 18    WHILE (cur_emp%FOUND) AND (i <= p_maxrows) LOOP
 19       i := i + 1;
 20       FETCH cur_emp INTO rec_emp;
 21       emp_tab(i) := rec_emp;
 22       v_city := get_location (rec_emp.department_name);
 23       dbms_output.put_line('Employee ' || rec_emp.last_name ||
 24         ' works in ' || v_city );
 25    END LOOP;
 26    CLOSE cur_emp;
 27    FOR j IN REVERSE 1..i LOOP
 28       DBMS_OUTPUT.PUT_LINE(emp_tab(j).last_name);
 29    END LOOP;
 30  END emp_list;
 31  /

Procedure created.

SQL> EXECUTE EMP_LIST(10);
Employee Grant works in South San Francisco                                                                                                                                                                                                                                                                 
Employee Whalen works in Seattle                                                                                                                                                                                                                                                                            
Employee Hartstein works in Toronto                                                                                                                                                                                                                                                                         
Employee Fay works in Toronto                                                                                                                                                                                                                                                                               
Employee Mavris works in London                                                                                                                                                                                                                                                                             
Employee Baer works in Munich                                                                                                                                                                                                                                                                               
Employee Higgins works in Seattle                                                                                                                                                                                                                                                                           
Employee Gietz works in Seattle                                                                                                                                                                                                                                                                             
Employee Smith works in Southlake                                                                                                                                                                                                                                                                           
Employee b works in South San Francisco                                                                                                                                                                                                                                                                     
b                                                                                                                                                                                                                                                                                                           
Smith                                                                                                                                                                                                                                                                                                       
Gietz                                                                                                                                                                                                                                                                                                       
Higgins                                                                                                                                                                                                                                                                                                     
Baer                                                                                                                                                                                                                                                                                                        
Mavris                                                                                                                                                                                                                                                                                                      
Fay                                                                                                                                                                                                                                                                                                         
Hartstein                                                                                                                                                                                                                                                                                                   
Whalen                                                                                                                                                                                                                                                                                                      
Grant                                                                                                                                                                                                                                                                                                       
OConnell                                                                                                                                                                                                                                                                                                    

PL/SQL procedure successfully completed.

SQL> EXIT
